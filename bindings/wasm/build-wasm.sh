#!/bin/bash

# Build script for Regorus WASM bindings
# This script compiles the Rust code to WebAssembly and generates JavaScript bindings

set -e

echo "ðŸ§¹ Cleaning previous build artifacts..."
cargo clean

echo "ðŸŽ¯ Building WASM target..."
RUSTFLAGS="--cfg getrandom_backend=\"wasm_js\"" cargo build --target wasm32-unknown-unknown --release

echo "ðŸ”— Generating JavaScript bindings..."
wasm-bindgen --target nodejs --out-dir pkg target/wasm32-unknown-unknown/release/regorusjs.wasm

echo "âœ… Build complete! Generated files:"
ls -la pkg/

echo "ðŸ§ª Running test..."
node test.js

echo "ðŸŽ‰ WASM build successful!"
